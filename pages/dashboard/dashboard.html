<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Fynix | Dashboard</title>
  <link rel="icon" type="image/png" href="/Expense-Tracker-FYNIX/assets/fynix_logo/logo_blue.png">

  <!-- Lucide Icons -->
  <script src="https://unpkg.com/lucide@latest"></script>

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <link rel="stylesheet" href="css/var.css" />
  <link rel="stylesheet" href="css/sidebar.css" />
  <link rel="stylesheet" href="css/dashboard.css" />
  <link rel="stylesheet" href="css/game.css" />

  <!-- tabs -->
  <link rel="stylesheet" href="css/tab-dashboard.css" />
  <link rel="stylesheet" href="css/add.css" />
  <link rel="stylesheet" href="css/bal.css" />
  <link rel="stylesheet" href="css/history.css" />


</head>

<body>
  <!-- Sidebar -->
  <aside class="sidebar">
    <div class="logo">
      <div class="logo-icon">
        <img src="/Expense-Tracker-FYNIX/assets/fynix_logo/logo_blue.png" alt="Logo" class="brand-logo">
      </div>
      <h2>FYNIX</h2>
    </div>

    <div class="menu-section">
      <ul class="menu-list">
        <li class="menu-item active" data-item="dashboard">
          <i data-lucide="layout-dashboard"></i> <span>Dashboard</span>
        </li>
        <li class="menu-item" data-item="add-expense">
          <i data-lucide="plus-circle"></i> <span>Add Transactions</span>
        </li>
        <li class="menu-item" data-item="balance-overview">
          <i data-lucide="wallet"></i> <span>Balance Overview</span>
        </li>
        <li class="menu-item" data-item="expense-history">
          <i data-lucide="activity"></i> <span>Expense History</span>
        </li>
        <li class="menu-item" data-item="gameTab">
          <i data-lucide="gamepad"></i>
          <span>Mini Game</span>
        </li>
        <li class="menu-item" id="logoutBtn">
          <i data-lucide="log-out"></i> <span>Sign Out</span>
        </li>
      </ul>
    </div>

    <div class="user-card">
      <img id="userAvatar" src="https://i.pravatar.cc/40" alt="User" class="user-avatar" />
      <div class="user-info">
        <p id="userName" class="user-name">Hinata Shoyo</p>
        <p id="userEmail" class="user-email">hinata@example.com</p>
      </div>
    </div>
  </aside>

  <!-- Main Content -->
  <main class="main-content">
    <!-- DASHBOARD -->
    <section id="dashboard" class="content-section active">
      <h1 class="section-title">Dashboard Overview</h1>

      <!-- CARDS -->
      <div class="cards-grid">
        <div class="stat-card">
          <div class="card-icon"><i data-lucide="wallet"></i></div>
          <div class="card-info">
            <h3>Total Expenses</h3>
            <p id="total-expenses">₱0.00</p>
          </div>
        </div>

        <div class="stat-card">
          <div class="card-icon"><i data-lucide="credit-card"></i></div>
          <div class="card-info">
            <h3>Current Balance</h3>
            <p id="dashboard-current-balance">₱0.00</p>
          </div>
        </div>

        <div class="stat-card">
          <div class="card-icon"><i data-lucide="piggy-bank"></i></div>
          <div class="card-info">
            <h3>Income</h3>
            <p id="total-income">₱0.00</p>
          </div>
        </div>
      </div>


      <!-- RECENT TRANSACTIONS -->
      <div class="recent-transactions">
        <h2>Recent Transactions</h2>
        <div class="table-container">
          <table>
            <thead>
              <tr>
                <th>Date</th>
                <th>Category</th>
                <th>Amount</th>
                <th>Note</th>
              </tr>
            </thead>
            <tbody id="recent-transactions-body">
              <!-- AJAX load -->
            </tbody>
          </table>
        </div>
      </div>


    </section>

    <!-- ADD EXPENSE -->
    <section id="add-expense" class="content-section">
      <h1 class="section-title">Add Transactions</h1>

      <div class="add-container">
        <!-- Add Expense Form (Left) -->
        <div class="form-side">
          <div class="form-header">
            <i data-lucide="arrow-down-circle"></i>
            <h2>Add Expense</h2>
          </div>

          <form id="expense-form" class="form-grid">
            <div class="form-group">
              <label>Category</label>
              <input type="text" id="expense-category" placeholder="e.g., Groceries, Transportation, Food" required />
            </div>

            <div class="form-group">
              <label>Amount</label>
              <input type="number" id="amount" placeholder="Enter amount" required />
            </div>

            <div class="form-group">
              <label>Note</label>
              <input type="text" id="note" placeholder="Optional note" />
            </div>

            <div class="form-group">
              <label>Date</label>
              <input type="date" id="date" required />
            </div>

            <button type="submit" class="btn-primary">Add Expense</button>
          </form>
        </div>

        <!-- Divider line -->
        <div class="divider-line"></div>

        <!-- Add Income Form (Right) -->
        <div class="form-side">
          <div class="form-header">
            <i data-lucide="arrow-up-circle"></i>
            <h2>Add Income</h2>
          </div>

          <form id="income-form" class="form-grid">
            <div class="form-group">
              <label>Source</label>
              <input type="text" id="income-source" placeholder="e.g., Salary, Freelance, Gift" required />
            </div>

            <div class="form-group">
              <label>Amount</label>
              <input type="number" id="income-amount" placeholder="Enter amount" required />
            </div>

            <div class="form-group">
              <label>Date</label>
              <input type="date" id="income-date" required />
            </div>

            <div class="form-group">
              <label>Note</label>
              <input type="text" id="income-note" placeholder="Optional note" />
            </div>

            <button type="submit" class="btn-primary">Add Income</button>
          </form>
        </div>
      </div>
    </section>


    <!-- BALANCE OVERVIEW -->
    <section id="balance-overview" class="content-section">
      <h1 class="section-title">Balance Overview</h1>

      <div class="balance-card">
        <!-- Overview Cards -->
        <div class="balance-stats">
          <div class="stat-card">
            <div class="card-icon">
              <i data-lucide="wallet"></i>
            </div>
            <div class="card-info">
              <h3>Current Balance</h3>
              <p id="balance-overview-current-balance" class="balance-value">₱0.00</p>
            </div>
          </div>

          <div class="stat-card">
            <div class="card-icon">
              <i data-lucide="trending-down"></i>
            </div>
            <div class="card-info">
              <h3>Total Expenses</h3>
              <p id="expenses" class="balance-value">₱0.00</p>
            </div>
          </div>

          <div class="stat-card">
            <div class="card-icon">
              <i data-lucide="trending-up"></i>
            </div>
            <div class="card-info">
              <h3>Total Income</h3>
              <p id="income" class="balance-value">₱0.00</p>
            </div>
          </div>
        </div>

        <!-- Update Balance Form -->
        <form id="balance-form" class="balance-form">
          <input type="number" id="new-balance" placeholder="Enter or update your balance" required />
          <button type="submit" class="btn-primary">
            <i data-lucide="refresh-cw"></i> Update Balance
          </button>
        </form>
      </div>
    </section>


    <!-- EXPENSE HISTORY -->
    <section id="expense-history" class="content-section">
      <h1 class="section-title">Expense History</h1>

      <!-- FILTER CARD -->
      <div class="history-filter-card">
        <div class="filters">
          <div class="filter-group">
            <label>Start Date</label>
            <input type="date" id="filter-start">
          </div>

          <div class="filter-group">
            <label>End Date</label>
            <input type="date" id="filter-end">
          </div>

          <button class="btn-primary" id="filter-btn">
            <i data-lucide="sliders-horizontal"></i> Filter
          </button>
        </div>
      </div>

      <!-- TABLE -->
      <div class="history-table-container">
        <table class="history-table">
          <thead>
            <tr>
              <th>Date</th>
              <th>Category</th>
              <th>Amount</th>
              <th>Note</th>
              <th>Actions</th>
            </tr>
          </thead>

          <tbody id="expense-history-tbody">
            <!-- Rows will be loaded dynamically -->
          </tbody>
        </table>
      </div>

    </section>

    <!-- ==================== EDIT MODAL ==================== -->
    <div id="edit-modal" class="modal-overlay hidden">
      <div class="modal">
        <h2>Edit Transaction</h2>
        <form id="edit-form">
          <input type="hidden" id="edit-id" />

          <div class="form-group">
            <label for="edit-date">Date</label>
            <input type="date" id="edit-date" required />
          </div>

          <div class="form-group">
            <label for="edit-category">Category</label>
            <input type="text" id="edit-category" placeholder="e.g. Food, Transport" required />
          </div>

          <div class="form-group">
            <label for="edit-amount">Amount (₱)</label>
            <input type="number" id="edit-amount" step="0.01" min="0" required />
          </div>

          <div class="form-group">
            <label for="edit-note">Note</label>
            <textarea id="edit-note" rows="3" placeholder="Optional note..."></textarea>
          </div>

          <div class="modal-actions">
            <button type="button" class="btn-secondary" id="close-edit-modal">Cancel</button>
            <button type="submit" class="btn-primary">Save Changes</button>
          </div>
        </form>
      </div>
    </div>


    <!-- MINI GAME -->
    <section id="gameTab" class="content-section game">

      <!-- ✅ Section Title -->
      <h1 class="section-title">Mini Game</h1>

      <div class="wrap">
        <div class="card gameCard">
          <div class="titleRow" aria-hidden="false">
            <div class="brand">
              <div>
                <h1>Expense Tetris</h1>
                <p class="small">Move falling categories into matching budget columns.
                  Arrow keys → left/right to move, down to drop.
                </p>
              </div>
            </div>
          </div>

          <div class="canvasWrap" style="position:relative">
            <canvas id="gameCanvas" width="800" height="520" aria-label="Expense Tetris game canvas"></canvas>
            <div id="overflow" class="overflowAnim">BUDGET OVERFLOW!</div>
          </div>

          <div class="controlsRow">
            <div class="legend" id="legend"></div>
            <div style="flex:1"></div>
            <div style="opacity:0.85">Difficulty: <span id="difficultyLabel">Normal</span></div>
          </div>
        </div>

        <aside class="card panel">
          <div class="stat">
            <h3>Score</h3>
            <div class="big" id="scoreDisplay">0</div>
          </div>
          <div class="stat">
            <h3>Lives</h3>
            <div class="big" id="livesDisplay">3</div>
          </div>
          <div class="stat">
            <h3>Level</h3>
            <div class="big" id="levelDisplay">1</div>
          </div>
          <div class="stat">
            <h3>High Score</h3>
            <div class="big" id="highScoreDisplay">—</div>
          </div>

          <div>
            <button id="startBtn" class="btn primary">Start</button>
            <button id="pauseBtn" class="btn">Pause</button>
            <button id="resetBtn" class="btn">Reset</button>
          </div>

          <div class="stat" style="margin-top:auto">
            <h3>Budget Columns</h3>
            <div id="columnsList" style="display:flex;flex-direction:column;gap:6px;margin-top:8px"></div>
          </div>
        </aside>
      </div>

    </section>



  </main>

  <!-- Logout Confirmation Modal -->
  <div id="logoutModal" class="logout-modal">
    <div class="card">
      <p class="cookieHeading">Leaving already?</p>
      <p class="cookieDescription">Don’t worry, your progress is saved. See you next time!</p>
      <div class="buttonContainer">
        <button class="acceptButton" id="confirmLogout">Yes, Sign Out</button>
        <button class="declineButton" id="cancelLogout">Cancel</button>
      </div>
    </div>
  </div>

  <script src="js/sidebar.js"></script>
  <script type="module" src="js/auth.js"></script>
  <script type="module" src="js/dasboard_auth.js"></script>
  <script type="module" src="js/game.js"></script>

  <script type="module" src="js/butt-db.js"></script>
  <script type="module" src="js/profile.js"></script>
</body>

</html>